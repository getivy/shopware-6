"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["wizmo-gmbh-ivy-payment"],{4608:(t,e,s)=>{var n=s(6285);class a extends n.Z{init(){var t=this.el.getElementsByTagName("template");Array.from(t).forEach((t=>{let e=Array.from(document.querySelectorAll("script")).map((t=>t.src));t.dataset.src&&(e.includes(t.dataset.src)?this.docLoaded():this.loadScript(t,this.docLoaded))}))}loadScript(t,e){var s=document.createElement("script");s.defer=!0,s.type="text/javascript",s.onreadystatechange=e,s.onload=e,s.src=t.dataset.src,document.head.append(s)}docLoaded(){window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0}))}}var o=s(8254),i=s(1966),r=s(2615),c=s(4690);var d=s(3206);const f=window.PluginManager;f.register("IvyPaymentOffcanvasCart",a,"#IvyOffcanvasCart"),f.register("IvyExpressCheckoutPlugin",class extends a{init(){super.init(),this._client=new o.Z,this.addEventListeners()}addEventListeners(){this.el.addEventListener("click",this.createSession.bind(this))}createSession(){if(c.Z.create(document.body),r.Z.close(),this.el.dataset.addToIvycart){const t=document.querySelector("#productDetailPageBuyProductForm");t&&fetch(t.action,{method:t.method,body:new FormData(t)}).then(function(t){t.ok?(this._fetchCartWidgets(),this.openIviPopup()):c.Z.remove(document.body)}.bind(this))}else this.openIviPopup()}_fetchCartWidgets(){const t=PluginManager.getPluginInstances("CartWidget");i.Z.iterate(t,(t=>t.fetch())),this.$emitter.publish("fetchCartWidgets")}openIviPopup(){this._client.get(this.el.dataset.action,(function(t){c.Z.remove(document.body);let e=JSON.parse(t);e.redirectUrl?"function"==typeof startIvyCheckout?startIvyCheckout(e.redirectUrl,"popup"):console.error("startIvyCheckout is not defined"):(console.error("cannot create ivy session"),location.reload())}))}},".ivy--express-checkout-btn"),f.register("IvyCheckoutConfirmPlugin",class extends a{init(){super.init(),this._client=new o.Z,this.confirmOrderForm=d.Z.querySelector(document,"#confirmOrderForm"),this.confirmFormSubmit=d.Z.querySelector(document,'#confirmOrderForm button[type="submit"]'),this.confirmFormSubmit.addEventListener("click",this.onConfirmOrderSubmit.bind(this))}onConfirmOrderSubmit(){this.confirmOrderForm.checkValidity()&&(event.preventDefault(),this.createSession())}createSession(){c.Z.create(document.body),r.Z.close(),this._client.get(this.el.dataset.action,(function(t){c.Z.remove(document.body);let e=JSON.parse(t);e.redirectUrl?"function"==typeof startIvyCheckout?startIvyCheckout(e.redirectUrl,"popup"):console.error("startIvyCheckout is not defined"):(console.error("cannot create ivy session"),location.reload())}))}},'[data-ivy-checkout="true"]'),f.register("IvyPaymentMethod",a,"#ivy-payment-method")},2615:(t,e,s)=>{s.d(e,{Z:()=>r});var n=s(3637),a=s(8254),o=s(7906);let i=null;class r extends n.Z{static open(t=!1,e=!1,s=null,a="left",o=!0,i=n.Z.REMOVE_OFF_CANVAS_DELAY(),r=!1,c=""){if(!t)throw new Error("A url must be given!");n.r._removeExistingOffCanvas();const d=n.r._createOffCanvas(a,r,c,o);this.setContent(t,e,s,o,i),n.r._openOffcanvas(d)}static setContent(t,e,s,n,c){const d=new a.Z;super.setContent(`<div class="offcanvas-body">${o.Z.getTemplate()}</div>`,n,c),i&&i.abort();const f=t=>{super.setContent(t,n,c),"function"==typeof s&&s(t)};i=e?d.post(t,e,r.executeCallback.bind(this,f)):d.get(t,r.executeCallback.bind(this,f))}static executeCallback(t,e){"function"==typeof t&&t(e),window.PluginManager.initializePlugins()}}},3637:(t,e,s)=>{s.d(e,{Z:()=>f,r:()=>d});var n=s(9658),a=s(2005),o=s(1966);const i="offcanvas",r=350;class c{constructor(){this.$emitter=new a.Z}open(t,e,s,n,a,o,i){this._removeExistingOffCanvas();const r=this._createOffCanvas(s,o,i,n);this.setContent(t,n,a),this._openOffcanvas(r,e)}setContent(t,e,s){const n=this.getOffCanvas();n[0]&&(n[0].innerHTML=t,this._registerEvents(s))}setAdditionalClassName(t){this.getOffCanvas()[0].classList.add(t)}getOffCanvas(){return document.querySelectorAll(`.${i}`)}close(t){const e=this.getOffCanvas();o.Z.iterate(e,(t=>{bootstrap.Offcanvas.getInstance(t).hide()})),setTimeout((()=>{this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:e})}),t)}goBackInHistory(){window.history.back()}exists(){return this.getOffCanvas().length>0}_openOffcanvas(t,e){c.bsOffcanvas.show(),window.history.pushState("offcanvas-open",""),"function"==typeof e&&e()}_registerEvents(t){const e=n.Z.isTouchDevice()?"touchend":"click",s=this.getOffCanvas();o.Z.iterate(s,(e=>{const n=()=>{setTimeout((()=>{e.remove(),this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:s})}),t),e.removeEventListener("hide.bs.offcanvas",n)};e.addEventListener("hide.bs.offcanvas",n)})),window.addEventListener("popstate",this.close.bind(this,t),{once:!0});const a=document.querySelectorAll(".js-offcanvas-close");o.Z.iterate(a,(s=>s.addEventListener(e,this.close.bind(this,t))))}_removeExistingOffCanvas(){c.bsOffcanvas=null;const t=this.getOffCanvas();return o.Z.iterate(t,(t=>t.remove()))}_getPositionClass(t){return"left"===t?"offcanvas-start":"right"===t?"offcanvas-end":`offcanvas-${t}`}_createOffCanvas(t,e,s,n){const a=document.createElement("div");if(a.classList.add(i),a.classList.add(this._getPositionClass(t)),!0===e&&a.classList.add("is-fullwidth"),s){const t=typeof s;if("string"===t)a.classList.add(s);else{if(!Array.isArray(s))throw new Error(`The type "${t}" is not supported. Please pass an array or a string.`);s.forEach((t=>{a.classList.add(t)}))}}return document.body.appendChild(a),c.bsOffcanvas=new bootstrap.Offcanvas(a,{backdrop:!1!==n||"static"}),a}}const d=Object.freeze(new c);class f{static open(t,e=null,s="left",n=!0,a=350,o=!1,i=""){d.open(t,e,s,n,a,o,i)}static setContent(t,e=!0,s=350){d.setContent(t,e,s)}static setAdditionalClassName(t){d.setAdditionalClassName(t)}static close(t=350){d.close(t)}static exists(){return d.exists()}static getOffCanvas(){return d.getOffCanvas()}static REMOVE_OFF_CANVAS_DELAY(){return r}}}},t=>{t.O(0,["vendor-node","vendor-shared"],(()=>{return e=4608,t(t.s=e);var e}));t.O()}]);